<%@ page language="java" contentType="application/msexcel" pageEncoding="UTF-8"%>
<%
response.setHeader("Content-type", "application/octetstream; name=ExportNoticeByArrivalReport.xls");
response.setHeader("Content-Disposition", "attachment; filename=ExportNoticeByArrivalReport.xls;");
response.setHeader("Content-Transfer-Encoding", "binary");
response.setHeader("Cache-Control", "cache, must-revalidate");
response.setHeader("Pragma", "public");
response.setHeader("Expires", "0");
%>
<%@ include file="/common/head.jsp"%>
<%-- 因報表使用jsp直接轉成excel的方式，排版方式會產生很多空白資料(尤其有foreach判斷之區塊)，造成excel檔案爆大，影響開啟檔案之效能，故於td tag中去除所有的排版以解決此問題。 --%>
<c:if test="${not empty noticeByArrivalList}">
<form>
<div class="dataBody" style="width: 100%">
<table id="docList">
<caption><b>貨到通知日報表</b></caption>
<thead>
<tr><td colspan="2" style='mso-number-format: "\@";'><c:if test="${process == 'reactdate'}" >反應日期：<c:if test="${(showFromDate ne null) && (showEndDate ne null)}">起：<fmt:formatDate value="${showFromDate}" pattern="yyyy/MM/dd" />～迄：<fmt:formatDate	value="${showEndDate}" pattern="yyyy/MM/dd" /></c:if></c:if><c:if test="${process == 'productno'}" >商品料號：${fetNo}</c:if></td></tr>
<tr><td colspan="2" style='mso-number-format: "\@";'>通知狀態：<c:if test="${process == 'reactdate'}" ><c:if test="${notice1 == ''}" >未通知</c:if><c:if test="${notice1 == 'true'}" >已通知</c:if></c:if><c:if test="${process == 'productno'}" ><c:if test="${notice2 == ''}" >未通知</c:if><c:if test="${notice2 == 'true'}" >已通知</c:if></c:if></td></tr>
<tr><td colspan="2" style='mso-number-format: "\@";'>報表產生日：${reportDate}</td></tr>
<tr>
<th>商品料號</th>
<th>商品名稱</th>
<th>商品顏色</th>
<th>客戶姓名</th>
<th>聯絡電話</th>
<th>聯絡手機</th>
<th>電子郵件</th>
<th>反應時間</th>		
<th>已通知日期</th>	
</tr>
</thead>
<tbody>
<c:forEach items="${noticeByArrivalList}" var="showResult" varStatus="status">
<tr>
<td style='mso-number-format:"\@";'>${showResult.fetNo}</td>
<td style='mso-number-format:"\@";'><c:if test="${showResult.product != null }"><c:set var="product" value="${showResult.product}" />${product.name}</c:if></td>
<td style='mso-number-format:"\@";'><c:if test="${showResult.product != null }"><c:set var="product" value="${showResult.product}" />${product.refColor.color}</c:if></td>
<td style='mso-number-format:"\@";'>${showResult.hiddenName}</td>
<td style='mso-number-format:"\@";'>${showResult.tel}</td>
<td style='mso-number-format:"\@";'>${showResult.mobile}</td>
<td style='mso-number-format:"\@";'>${showResult.email}</td>
<td style='mso-number-format:"\@";'><fmt:formatDate value="${showResult.issueDate}" pattern="yyyy/MM/dd HH:mm:ss" /></td>
<td style='mso-number-format:"\@";'><fmt:formatDate value="${showResult.handleDate}" pattern="yyyy/MM/dd" /></td>
</tr>
</c:forEach>
</tbody>
</table>
</div>
</form>
</c:if>

